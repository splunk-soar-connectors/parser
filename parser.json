{
    "appid": "4004f489-1826-44a1-af12-9c74eea82eb0",
    "name": "Parser",
    "description": "This app extracts IOCs from various files such as PDFs, emails, or raw text",
    "type": "information",
    "product_vendor": "Splunk",
    "logo": "logo_splunk.svg",
    "logo_dark": "logo_splunk_dark.svg",
    "product_name": "Parser",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2017-2021 Splunk Inc.",
    "app_version": "2.4.7",
    "utctime_updated": "2021-11-11T09:18:48.000000Z",
    "package_name": "phantom_parser",
    "main_module": "parser_connector.py",
    "min_phantom_version": "4.10.0.40961",
    "python_version": "3",
    "latest_tested_versions": [
        "Module pdfminer.six-20201018.tar.gz, October 25 2021",
        "Module pdfminer-20140328-py2-none-any.whl, October 25 2021"
    ],
    "app_wizard_version": "1.0.0",
    "pip_dependencies": {
        "wheel": [
            {
                "module": "defusedxml",
                "input_file": "wheels/defusedxml-0.7.1-py2.py3-none-any.whl"
            },
            {
                "module": "pdfminer",
                "input_file": "wheels/pdfminer-20140328-py2-none-any.whl"
            }
        ]
    },
    "pip3_dependencies": {
        "wheel": [
            {
                "module": "beautifulsoup4",
                "input_file": "wheels/py3/beautifulsoup4-4.9.1-py3-none-any.whl"
            },
            {
                "module": "certifi",
                "input_file": "wheels/shared/certifi-2021.10.8-py2.py3-none-any.whl"
            },
            {
                "module": "chardet",
                "input_file": "wheels/shared/chardet-3.0.4-py2.py3-none-any.whl"
            },
            {
                "module": "defusedxml",
                "input_file": "wheels/shared/defusedxml-0.7.1-py2.py3-none-any.whl"
            },
            {
                "module": "idna",
                "input_file": "wheels/shared/idna-2.10-py2.py3-none-any.whl"
            },
            {
                "module": "pdfminer",
                "input_file": "wheels/py3/pdfminer-20191125-py3-none-any.whl"
            },
            {
                "module": "pycryptodome",
                "input_file": "wheels/py3/pycryptodome-3.11.0-cp35-abi3-manylinux2010_x86_64.manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl"
            },
            {
                "module": "python_magic",
                "input_file": "wheels/shared/python_magic-0.4.18-py2.py3-none-any.whl"
            },
            {
                "module": "requests",
                "input_file": "wheels/shared/requests-2.25.0-py2.py3-none-any.whl"
            },
            {
                "module": "simplejson",
                "input_file": "wheels/py3/simplejson-3.17.2-cp36-cp36m-manylinux2010_x86_64.manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl"
            },
            {
                "module": "soupsieve",
                "input_file": "wheels/py3/soupsieve-2.3.1-py3-none-any.whl"
            },
            {
                "module": "urllib3",
                "input_file": "wheels/shared/urllib3-1.26.7-py2.py3-none-any.whl"
            }
        ]
    },
    "configuration": {},
    "actions": [
        {
            "action": "extract ioc",
            "identifier": "parse_file",
            "description": "Create IOC artifacts from a file in the vault or raw text",
            "verbose": "Specify either text or vault_id. If text is used only file_types of csv, html, and txt can be selected. <br/><br/>If vault_id is used and the [file_type] is left blank, the app will try to determine what type of file it is on its own. <br/><br/> When parsing an email file (.eml), the <b>file_type</b> parameter must be set to <b>email</b>. <br/> <br/> <b>Label</b> or <b>Container ID</b> is mandatory to run an action. It will display an error message if both of them are not mentioned. <br/> <br/> <b> Caveats:</b> <ul><li>If the [file_type] you chose related to [vault_id] is incorrect, you will have an unexpected output scenario.</li></ul>",
            "type": "generic",
            "read_only": true,
            "parameters": {
                "vault_id": {
                    "description": "Vault ID",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "vault id"
                    ],
                    "order": 0
                },
                "file_type": {
                    "description": "Type of the file",
                    "data_type": "string",
                    "value_list": [
                        "txt",
                        "email",
                        "pdf",
                        "docx",
                        "csv",
                        "html"
                    ],
                    "order": 1
                },
                "text": {
                    "description": "Raw text from which to extract IOCs",
                    "data_type": "string",
                    "order": 2
                },
                "is_structured": {
                    "description": "Use first row of CSV file as field names",
                    "data_type": "boolean",
                    "default": false,
                    "order": 3
                },
                "label": {
                    "description": "Add container to this label",
                    "data_type": "string",
                    "order": 4
                },
                "max_artifacts": {
                    "description": "Maximum number of artifacts (not applicable to .eml filetype)",
                    "data_type": "numeric",
                    "order": 5
                },
                "container_id": {
                    "description": "Add created artifacts to this container",
                    "data_type": "numeric",
                    "order": 6
                },
                "remap_cef_fields": {
                    "description": "Remap the CEF fields with new field names; Optionally, also apply an internal CEF -> CIM field name mapping. Note: (source|destination)Address will be mapped to (src|dest)_ip respectively instead of src|dest (not applicable to .eml filetype)",
                    "data_type": "string",
                    "default": "Do not apply CEF -> CIM remapping, only apply custom remap",
                    "value_list": [
                        "Do not apply CEF -> CIM remapping, only apply custom remap",
                        "Apply CEF -> CIM remapping before applying custom remap",
                        "Apply custom remap and apply CEF -> CIM remapping after"
                    ],
                    "order": 7
                },
                "custom_remap_json": {
                    "description": "Custom set of CEF field name mappings. This is a serialized json dictionary (json.dumps) of Key/Value pairs where Key is an existing field name and Value is the resultant name (not applicable to .eml filetype)",
                    "data_type": "string",
                    "default": "{}",
                    "order": 8
                },
                "run_automation": {
                    "description": "Enable run_automation for newly created artifacts",
                    "data_type": "boolean",
                    "default": true,
                    "order": 9
                },
                "severity": {
                    "description": "Severity for the newly created artifacts",
                    "data_type": "string",
                    "default": "medium",
                    "order": 10
                },
                "parse_domains": {
                    "description": "Parse domains from artifacts",
                    "data_type": "boolean",
                    "default": true,
                    "order": 11
                },
                "artifact_tags": {
                    "description": "Tags to add to artifacts (comma separated). Tag should only contain characters A-Z, a-z, 0-9, _, and -. Blank spaces will be ignored",
                    "data_type": "string",
                    "order": 12
                },
                "keep_raw": {
                    "description": "Save raw text to artifact",
                    "data_type": "boolean",
                    "default": false,
                    "order": 13
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.container_id",
                    "data_type": "numeric",
                    "example_values": [
                        1776
                    ]
                },
                {
                    "data_path": "action_result.parameter.custom_remap_json",
                    "data_type": "string",
                    "example_values": [
                        "{\"a\": \"fileHash\", \"b\": \"sourceAddress\"}"
                    ]
                },
                {
                    "data_path": "action_result.parameter.file_type",
                    "data_type": "string",
                    "example_values": [
                        "txt",
                        "email",
                        "pdf",
                        "docx",
                        "csv",
                        "html"
                    ]
                },
                {
                    "data_path": "action_result.parameter.is_structured",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.parameter.label",
                    "data_type": "string",
                    "example_values": [
                        "Events"
                    ]
                },
                {
                    "data_path": "action_result.parameter.max_artifacts",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.parameter.parse_domains",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.parameter.keep_raw",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.parameter.artifact_tags",
                    "data_type": "string",
                    "example_values": [
                        "tag1, tag2"
                    ]
                },
                {
                    "data_path": "action_result.parameter.remap_cef_fields",
                    "data_type": "string",
                    "example_values": [
                        "Apply custom remap and apply CEF -> CIM remapping after"
                    ]
                },
                {
                    "data_path": "action_result.parameter.run_automation",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.parameter.severity",
                    "data_type": "string",
                    "example_values": [
                        "low"
                    ]
                },
                {
                    "data_path": "action_result.parameter.text",
                    "data_type": "string",
                    "example_values": [
                        "Test string to extract IOCs from"
                    ]
                },
                {
                    "data_path": "action_result.parameter.vault_id",
                    "data_type": "string",
                    "example_values": [
                        "3d6ef06ab51be5a86cdfaba246db2c2ab1d07795"
                    ],
                    "contains": [
                        "vault id"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.artifacts_ingested",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.summary.artifacts_found",
                    "data_type": "numeric",
                    "example_values": [
                        13
                    ]
                },
                {
                    "data_path": "action_result.summary.container_id",
                    "data_type": "numeric",
                    "example_values": [
                        1776
                    ],
                    "column_order": 0,
                    "column_name": "Container ID"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Container id: 52069, Artifacts found: 27"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.To",
                    "data_type": "string",
                    "example_values": [
                        "xyz@xyz.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Date",
                    "data_type": "string",
                    "example_values": [
                        "Mon, 19 Jul 2021 11:18:40 +0530"
                    ]
                },
                {
                    "data_path": "action_result.data.*.From",
                    "data_type": "string",
                    "example_values": [
                        "xyz@xyz.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Subject",
                    "data_type": "string",
                    "example_values": [
                        "=?UTF-8?B?5paw44GX44GESUTF-8?B?MeOBpOOCkuS9v+eUqOOBl+OBpuOAgeS4gOaEj+OBruODquODs+OCr+ODreODvOOCq+ODq+OCouODiQ==?=\r\n\t="
                    ]
                },
                {
                    "data_path": "action_result.data.*.Content-Type",
                    "data_type": "string",
                    "example_values": [
                        "multipart/alternative; boundary=\"0000000000005233b405c7737dbe\""
                    ]
                },
                {
                    "data_path": "action_result.data.*.X-MS-Has-Attach",
                    "data_type": "string",
                    "example_values": [
                        "yes"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Content-Language",
                    "data_type": "string",
                    "example_values": [
                        "en-US"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Message-ID",
                    "data_type": "string",
                    "example_values": [
                        "<xyz@mail.gmail.com>"
                    ]
                },
                {
                    "data_path": "action_result.data.*.MIME-Version",
                    "data_type": "string",
                    "example_values": [
                        "1.0"
                    ]
                },
                {
                    "data_path": "action_result.data.*.References",
                    "data_type": "string",
                    "example_values": [
                        "<xyz@mail.gmail.com>"
                    ]
                },
                {
                    "data_path": "action_result.data.*.In-Reply-To",
                    "data_type": "string",
                    "example_values": [
                        "<CAGUkOuok3+qiuH4rCNKf=6_a4qwRViq=1WTro1pB8zSVqEujog@mail.gmail.com>"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Thread-Index",
                    "data_type": "string",
                    "example_values": [
                        "AQHWF83DD6R+qs4BTUSciZoeNB7NYw=="
                    ]
                },
                {
                    "data_path": "action_result.data.*.Thread-Topic",
                    "data_type": "string",
                    "example_values": [
                        "\r\n\t=?utf-8?B?5ryi5a2XwqnCrMm40aDWjdue4KiK4K+14LWs4LyD4YCk4YSo4YeX4YqW4Y+M?=\r\n"
                    ]
                },
                {
                    "data_path": "action_result.data.*.X-MS-TNEF-Correlator",
                    "data_type": "string",
                    "example_values": [
                        "xyz"
                    ]
                },
                {
                    "data_path": "action_result.data.*.X-MS-Exchange-Organization-SCL",
                    "data_type": "string",
                    "example_values": [
                        "-1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.X-MS-Exchange-Organization-RecordReviewCfmType",
                    "data_type": "string",
                    "example_values": [
                        "0"
                    ]
                }
            ],
            "render": {
                "width": 12,
                "title": "Parse File",
                "type": "table",
                "height": 5
            },
            "versions": "EQ(*)"
        }
    ]
}
